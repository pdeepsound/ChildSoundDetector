# Recognition of Baby Sounds
 Репозиторий содержит код проекта, примеры использования моделей и предобученные модели для различных задач распознавания звуков на аудиосигнале:
 1) Детектирование голоса няни;
 2) Детектирование звуков ребенка;
 3) Детектирование плача ребенка;
 4) Классификация детских звуков (крик, смех, плач, пение);
 5) Классификация плача ребенка (плач по причине боли, плач по другой причине).
 Также описывается точность моделей на тестовых данных для всех пяти задач.

Архитектура моделей описана в нашей статье: **[ERANNs: Efficient Residual Audio Neural Networks for Audio Pattern Recognition](https://arxiv.org/abs/2106.01621)**. Для данной задачи была дообучена лучшая модель (**ERANN-8x2-6**), обученная на крупном наборе данных для распозвания звуковых образов [AudioSet](http://research.google.com/audioset/), который имеет более двух миллионов аудиосигналов и 527 различных классов звуков. Лучшая модель достигает **state-of-the-art точность** для этого набора данных: **0.450 по метрике mAP** на валидационной выборке.

Обучающая и валидационная выборка для задачи распознавания звуков детей были сформированы с помощью набора данных AudioSet. Было выбрано только 4 класса (**Children shouting, Baby laughter, Baby cry, Child singing**) и соответствующие к ним аудиосигналы. Примеров в обучающей выборке: 5396, примеров в валидационной выборке: 204.

## Настройка окружения
Для использования моделей необходимо наличие Python 3.7 (и выше) и предустановленных пакетов:

```
pip install -r requirements.txt
```

## Использование предобученных моделей
Для использования системы распознавания звуков детей необходимо загрузить предобученную модель. Предобученная модель может быть загружена по [ссылке](https://drive.google.com/file/d/146KR9GxppqiCRfJFBp83EiuV68UIbkwy/view?usp=sharing).

Далее для получения результатов распознавания четырех классов звуков детей на аудиосигнале необходимо воспользоваться следующей командой:
```
python inference.py --MODEL_PATH path_to_model --AUDIO_PATH path_to_audio --CUDA True
```
Описание аргументов:
- **path_to_model** - путь до предобученной модели;
- **path_to_audio** - путь до аудиосигнала;
- **CUDA True** если использовать графический процессор, иначе **CUDA False** (по умолчанию).

Например, результат распознавания на [аудиосигнале](https://drive.google.com/file/d/1NBUqq8JvtsNxo9zWrU4GrcoI9Xo52d2P/view?usp=sharing) (с плачем ребенка):
```
РЕЗУЛЬТАТ:

Детский крик: 0.07
Детский смех: 0.06
Детский плач: 0.84
Детское пение: 0.05

На аудиосигнале обнаружено: Детский плач
```

Результат распознавания на [аудиосигнале](https://drive.google.com/file/d/1yKgAPiZ4NQgfwu7LyBcV8m1CI0uKfB4Q/view?usp=sharing) (звуки природы без звуков детей):
```
РЕЗУЛЬТАТ:

Детский крик: 0.11
Детский смех: 0.25
Детский плач: 0.33
Детское пение: 0.17

Ничего из 4х классов на аудиосигнале не обнаружено
```
## Точность моделей
В данной секции описываются результаты точности модели (которая доступна по [ссылке](dfsd)). 

Порог (threshold) принятия класса для всех классов одинаковый и равен 0.5. Все метрики - макро.

Точность определения каждого класса на вадиционной выборке, полученной из набора данных AudioSet:
| Класс звука   | Accuracy      | F1 score      | Precision     | Количество примеров |
| ------------- | :---: | :---: | :---: | :---: | 
| Крик ребенка | 0.965 |  0.975 |  0.987  |  57 | 
| Смех ребенка | 0.926 |  0.936 |  0.948  |  55 | 
| Плач ребенка | 0.901 |  0.917 |  0.936  |  39 | 
| Пение ребенка | 0.962 |  0.974 |  0.987  |  53 | 

Точность по всем классам (усредненная):
|  Accuracy      |  F1-score      |  Precision       | Количество примеров |
| :---: | :---: | :---: |  :---: | 
| 0.939  | 0.951 | 0.965 | 204 |


